{% load static %}
<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>íšŒì›ê°€ì…</title>
  <link rel="stylesheet" href="{% static 'uauth/css/signup.css' %}">
</head>
<body>
  <header class="page" aria-labelledby="pagetitle">
    <h1 id="pagetitle">íšŒì›ê°€ì…</h1>
    <p>íšŒì›ê°€ì…ì„ ìœ„í•œ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</p>
  </header>

  <main class="card" role="main" aria-labelledby="sectionTitle">
    <div class="section-desc">ì•„ë˜ ì •ë³´ë¥¼ ì…ë ¥í•˜ì—¬ íšŒì›ê°€ì…ì„ ì™„ë£Œí•´ì£¼ì„¸ìš”.</div>

    <form id="registerForm" class="form" method="post" action="{% url 'uauth:signup' %}" novalidate enctype="multipart/form-data">
      {% csrf_token %}

      {# ğŸ”§ ì¶”ê°€: ì „ì²´(non-field) ì—ëŸ¬ í‘œì‹œ #}
      {% if form and form.non_field_errors %}
        <div class="error nonfield">
          {% for err in form.non_field_errors %}<p>{{ err }}</p>{% endfor %}
        </div>
      {% endif %}
      <div class="grid">
        <div class="form-item full profile-row">
          <label for="profile_image">í”„ë¡œí•„ ì´ë¯¸ì§€</label>

          <div class="profile-flex">
            <!-- ì™¼ìª½: ë¯¸ë¦¬ë³´ê¸° -->
            <div class="avatar-preview">
              <img id="profilePreview" alt="í”„ë¡œí•„ ë¯¸ë¦¬ë³´ê¸°" style="display:none;">
            </div>

            <!-- ì˜¤ë¥¸ìª½: íŒŒì¼ ì„ íƒ -->
            <div class="file-input">
              <input id="profile_image" name="profile_image" type="file" accept="image/*" aria-describedby="profileImageErr">
              <div id="profileImageErr" class="error"></div>
            </div> <!-- â¬…ï¸ file-input ë‹«ê¸° -->
          </div>   <!-- â¬…ï¸ profile-flex ë‹«ê¸° -->
        </div> 
   
        <!-- ì•„ì´ë”” -->
        <div class="form-item">
          <label for="userId">ì•„ì´ë””</label>
          <input id="userId" name="userId" type="text" placeholder="ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
                 required minlength="4" maxlength="20"
                 pattern="^[a-zA-Z0-9_]{4,20}$" autocomplete="username" aria-describedby="userIdErr"
                 {# ğŸ”§ ì¶”ê°€: ê°’ ìœ ì§€ & ì—ëŸ¬ì‹œ aria-invalid #}
                 value="{{ form.userId.value|default:'' }}"
                 {% if form.userId.errors %}aria-invalid="true"{% endif %}>
          <div id="userIdErr" class="error">
            {# ğŸ”§ ì¶”ê°€: í•„ë“œ ì—ëŸ¬ ì¶œë ¥ (ì¤‘ë³µ ì•„ì´ë”” ë©”ì‹œì§€ê°€ ì—¬ê¸°ë¡œ ì˜´) #}
            {% for err in form.userId.errors %}<p>{{ err }}</p>{% endfor %}
          </div>
        </div>

        <!-- ì´ë¦„ -->
        <div class="form-item">
          <label for="name">ì´ë¦„</label>
          <input id="name" name="name" type="text" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”"
                 required minlength="2" maxlength="10" aria-describedby="nameErr"
                 value="{{ form.name.value|default:'' }}"
                 {% if form.name.errors %}aria-invalid="true"{% endif %}>
          <div id="nameErr" class="error">
            {% for err in form.name.errors %}<p>{{ err }}</p>{% endfor %}
          </div>
        </div>

        <!-- ë¹„ë°€ë²ˆí˜¸ -->
        <div class="form-item">
          <label for="password">ë¹„ë°€ë²ˆí˜¸</label>
          <div class="password-wrap">
            <input id="password" name="password" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
                   required pattern="^(?=.*[a-z])(?=.*\d)(?=.*[@$!%*?&])[a-z\d@$!%*?&]{8,}$"
                   aria-describedby="passwordErr" autocomplete="new-password"
                   {% if form.password.errors %}aria-invalid="true"{% endif %}>
            <button class="toggle" type="button" aria-label="ë¹„ë°€ë²ˆí˜¸ í‘œì‹œ" aria-pressed="false" data-target="password">
              <svg class="eye-icon eye-on" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                <circle cx="12" cy="12" r="3"/>
              </svg>
              <svg class="eye-icon eye-off" style="display:none;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94"/>
                <path d="M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19"/>
                <path d="M14.12 14.12a3 3 0 1 1-4.24-4.24"/>
                <line x1="1" y1="1" x2="23" y2="23"/>
              </svg>
            </button>
          </div>
          <div id="passwordErr" class="error">
            {% for err in form.password.errors %}<p>{{ err }}</p>{% endfor %}
          </div>
        </div>

        <!-- ë¹„ë°€ë²ˆí˜¸ í™•ì¸ -->
        <div class="form-item">
          <label for="confirmPassword">ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
          <div class="password-wrap">
            <input id="confirmPassword" name="confirmPassword" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ ì…ë ¥í•˜ì„¸ìš”"
                   required aria-describedby="confirmErr" autocomplete="new-password"
                   {% if form.confirmPassword.errors %}aria-invalid="true"{% endif %}>
            <button class="toggle" type="button" aria-label="ë¹„ë°€ë²ˆí˜¸ í‘œì‹œ" aria-pressed="false" data-target="confirmPassword">
              <svg class="eye-icon eye-on" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                <circle cx="12" cy="12" r="3"/>
              </svg>
              <svg class="eye-icon eye-off" style="display:none;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94"/>
                <path d="M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19"/>
                <path d="M14.12 14.12a3 3 0 1 1-4.24-4.24"/>
                <line x1="1" y1="1" x2="23" y2="23"/>
              </svg>
            </button>
          </div>
          <div id="confirmErr" class="error">
            {% for err in form.confirmPassword.errors %}<p>{{ err }}</p>{% endfor %}
          </div>
        </div>

        <!-- ì§ê¸‰ -->
        <div class="form-item">
          <label for="role">ì§ê¸‰</label>
          <select id="role" name="role" required aria-describedby="roleErr"
                  {% if form.role.errors %}aria-invalid="true"{% endif %}>
            <option value="" {% if not form.role.value %}selected{% endif %} disabled>ì§ê¸‰ì„ ì„ íƒí•˜ì„¸ìš”</option>
            {% for code, label in ranks %}
              <option value="{{ code }}" {% if form.role.value == code %}selected{% endif %}>{{ label }}</option>
            {% endfor %}
          </select>
          <div id="roleErr" class="error">
            {% for err in form.role.errors %}<p>{{ err }}</p>{% endfor %}
          </div>
        </div>

        <!-- íŒ€ -->
        <div class="form-item">
          <label for="team">íŒ€</label>
          <select id="team" name="team" required aria-describedby="teamErr"
                  {% if form.team.errors %}aria-invalid="true"{% endif %}>
            <option value="" {% if not form.team.value %}selected{% endif %} disabled>íŒ€ì„ ì„ íƒí•˜ì„¸ìš”</option>
            {% for code, label in departments %}
              <option value="{{ code }}" {% if form.team.value == code %}selected{% endif %}>{{ label }}</option>
            {% endfor %}
          </select>
          <div id="teamErr" class="error">
            {% for err in form.team.errors %}<p>{{ err }}</p>{% endfor %}
          </div>
        </div>

        <!-- ì´ë©”ì¼ -->
        <div class="form-item full">
          <label for="email">ì´ë©”ì¼</label>
          <input id="email" name="email" type="email" placeholder="ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”"
                 required aria-describedby="emailErr" autocomplete="email"
                 value="{{ form.email.value|default:'' }}"
                 {% if form.email.errors %}aria-invalid="true"{% endif %}>
          <div id="emailErr" class="error">
            {% for err in form.email.errors %}<p>{{ err }}</p>{% endfor %}
          </div>
        </div>

        <!-- ì„±ë³„ -->
        <div class="form-item">
          <label for="gender">ì„±ë³„</label>
          <select id="gender" name="gender" required aria-describedby="genderErr"
                  {% if form.gender.errors %}aria-invalid="true"{% endif %}>
            <option value="" {% if not form.gender.value %}selected{% endif %} disabled>ì„±ë³„ì„ ì„ íƒí•˜ì„¸ìš”</option>
            {% for code, label in genders %}
              <option value="{{ code }}" {% if form.gender.value == code %}selected{% endif %}>{{ label }}</option>
            {% endfor %}
          </select>
          <div id="genderErr" class="error">
            {% for err in form.gender.errors %}<p>{{ err }}</p>{% endfor %}
          </div>
        </div>

        <!-- ìƒë…„ì›”ì¼ -->
        <div class="form-item">
          <label for="birthDate">ìƒë…„ì›”ì¼</label>
          <input id="birthDate" name="birthDate" type="date" required aria-describedby="birthErr" min="1900-01-01"
                 value="{{ form.birthDate.value|default:'' }}"
                 {% if form.birthDate.errors %}aria-invalid="true"{% endif %}>
          <div id="birthErr" class="error">
            {% for err in form.birthDate.errors %}<p>{{ err }}</p>{% endfor %}
          </div>
        </div>

        <!-- ì „í™”ë²ˆí˜¸ -->
        <div class="form-item full">
          <label for="phoneNumber">ì „í™”ë²ˆí˜¸</label>
          <input id="phoneNumber" name="phoneNumber" type="text" inputmode="numeric"
                 placeholder="010-1234-5678" required pattern="^010-\d{4}-\d{4}$" aria-describedby="phoneErr"
                 value="{{ form.phoneNumber.value|default:'' }}"
                 {% if form.phoneNumber.errors %}aria-invalid="true"{% endif %}>
          <div id="phoneErr" class="error">
            {% for err in form.phoneNumber.errors %}<p>{{ err }}</p>{% endfor %}
          </div>
        </div>
      </div>

      <button type="submit" class="submit">íšŒì›ê°€ì…</button>
    </form>
  </main>

  <script src="{% static 'uauth/js/signup.js' %}"></script>
</body>
</html>
